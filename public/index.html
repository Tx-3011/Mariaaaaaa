<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>La Tavola</title>
  <link rel="stylesheet" href="css/styles.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body class="theme-classic">

  <header class="navbar">
    <h1>La Tavola</h1>
    <div class="controls">
        <div class="theme-selector">
          <label for="themeSelect">🎨 Theme:</label>
          <select id="themeSelect">
            <option value="classic">Classic 🇮🇹</option>
            <option value="modern">Modern 🌃</option>
            <option value="romantic">Romantic 🍷</option>
          </select>
        </div>
        <button id="darkModeToggle" class="toggle-btn" title="Toggle Dark Mode">🌙</button>
    </div>
  </header>

  <main>
    <section class="login" id="loginBox">
      <h2>Welcome to La Tavola</h2>
      <input type="text" id="name" placeholder="Your Name" required />
      <input type="tel" id="phone" placeholder="Phone Number" required />
      <button id="loginButton">Login</button>
      <p id="loginError" class="error-message" style="display: none;"></p>
    </section>

    <section id="menuSection" style="display: none;">
      <div class="user-info">
          Welcome, <span id="userNameDisplay">Guest</span>!
          <button id="logoutButton">Logout</button>
      </div>

       <div class="menu-controls">
           <div class="veg-toggle">
             <button id="vegToggleButton" class="veg-toggle-btn" title="Show only vegetarian items">
               🌿 Veg Only
             </button>
           </div>
           <div class="categories" id="categories">
               Loading categories...
           </div>
       </div>

      <div id="items" class="items">Loading menu...</div>

       <div class="cart-status">
         <i class="fas fa-shopping-cart"></i> Items in cart: <span id="cartCountStatus">0</span> | Total: ₹<span id="cartTotalStatus">0.00</span>
         <button id="seeCartButton" class="mini-btn">See Cart</button>
         <button id="checkoutButtonStatus" class="mini-btn checkout-btn" disabled>Checkout</button>
       </div>
      </section>
  </main>

  <div id="toast" class="toast"></div>

  <div id="cartModal" class="modal">
    <div class="modal-content">
      <span id="closeCartModalBtn" class="close-btn" title="Close Cart">&times;</span>
      <h2>Your Cart</h2>
      <div id="cartDetails">Your cart is empty.</div>
       <div class="cart-summary">
         <strong>Total: ₹<span id="cartModalTotal">0.00</span></strong>
       </div>
       <button id="checkoutButtonModal" class="checkout-btn" disabled>Checkout</button>
    </div>
  </div>

  <button id="cartFloatBtn" title="Open Cart Sidebar">
      <i class="fas fa-shopping-cart"></i> Cart (<span id="cartCountFloat">0</span>)
  </button>

  <div id="cartSidebar" class="cart-sidebar">
    <div class="cart-sidebar-header">
      <h3>Your Cart</h3>
      <button id="closeCartSidebarBtn" title="Close Sidebar">✖</button>
    </div>
    <div id="cartSidebarItems">Your cart is empty.</div>
     <div class="cart-sidebar-footer">
         <strong>Total: ₹<span id="cartSidebarTotal">0.00</span></strong>
         <button id="checkoutButtonSidebar" class="checkout-btn" disabled>Checkout</button>
     </div>
  </div>

  <div id="feedbackModal" class="modal">
    <div class="modal-content">
      <span id="closeFeedbackModalBtn" class="close-btn" title="Close Feedback">&times;</span>
      <h2>We value your feedback!</h2>
      <form id="feedbackForm">
        <label for="rating">Rate us:</label>
          <select id="rating" required>
            <option value="">-- Choose Rating --</option>
             <option value="5">⭐️⭐️⭐️⭐️⭐️ Excellent</option>
             <option value="4">⭐️⭐️⭐️⭐️ Good</option>
             <option value="3">⭐️⭐️⭐️ Average</option>
             <option value="2">⭐️⭐️ Fair</option>
             <option value="1">⭐️ Poor</option>
          </select>
        <br/><br/>
        <label for="feedbackText">Comments (Optional):</label><br/>
        <textarea id="feedbackText" rows="4" placeholder="Write something nice 😊..." style="width:100%;"></textarea><br/><br/>
        <button type="submit">Submit Feedback</button>
         <p id="feedbackError" class="error-message" style="display: none;"></p>
      </form>
    </div>
  </div>

  <footer class="footer">
    <p>Follow us:</p>
    <a href="https://instagram.com/yourprofile" target="_blank" rel="noopener noreferrer" title="Instagram">
      <img src="https://img.icons8.com/ios-filled/50/ffffff/instagram-new.png" class="social-icon" alt="Instagram"
           onerror="this.style.display='none'"/>
    </a>
    <a href="https://wa.me/919999999999" target="_blank" rel="noopener noreferrer" title="WhatsApp">
      <img src="https://img.icons8.com/ios-filled/50/ffffff/whatsapp.png" class="social-icon" alt="WhatsApp"
           onerror="this.style.display='none'"/>
    </a>
    <p>&copy; 2025 La Tavola. All rights reserved.</p>
  </footer>

  <script>
    const API_URL = '/api';
    let currentUser = null;
    let cart = [];
    let menuItemsData = [];
    let categoriesData = [];

    function escapeHTML(str) {
        if (typeof str !== 'string') return '';
        const div = document.createElement('div');
        div.textContent = str;
        return div.innerHTML;
    }
  </script>

  <script src="js/main.js"></script>
  <script src="js/feedback.js"></script>
  <script src="js/bill.js"></script>

  </body>
</html>
